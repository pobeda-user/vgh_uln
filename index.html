<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="theme-color" content="#e30613" />
  <link rel="icon" href="./assets/1757494154.png" type="image/png" />
  <link rel="manifest" href="./manifest.json" />
  <link rel="stylesheet" href="./styles.css" />
  <title>–í–ì–• / –ü—Ä–æ–±–ª–µ–º—ã</title>
</head>
<body>
  <main class="container">
    <div id="netIndicator" class="netIndicator" aria-label="–°—Ç–∞—Ç—É—Å —Å–µ—Ç–∏" title="–°—Ç–∞—Ç—É—Å —Å–µ—Ç–∏"></div>
    <div id="toastHost" class="toastHost" aria-live="polite" aria-atomic="true"></div>
    <button id="clearCacheBtn" type="button" class="clearCacheBtn" aria-label="–û–±–Ω–æ–≤–∏—Ç—å –∏ —Å–±—Ä–æ—Å–∏—Ç—å –ö–ï–®" title="–û–±–Ω–æ–≤–∏—Ç—å –∏ —Å–±—Ä–æ—Å–∏—Ç—å –ö–ï–®">–û–±–Ω–æ–≤–∏—Ç—å –∏ —Å–±—Ä–æ—Å–∏—Ç—å –ö–ï–®</button>
    
    <!-- Registration Screen -->
    <div id="registrationScreen" class="screen" style="display: none;">
      <div class="auth-card">
        <h2>üì± –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
        <form id="registrationForm">
          <div class="field">
            <span>üë§ –§–ò–û</span>
            <input type="text" id="regFio" name="fio" required />
          </div>
          <div class="field">
            <span>üì± –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞</span>
            <input type="tel" id="regPhone" name="phone" placeholder="+7XXXXXXXXXX" required />
          </div>
          <div class="field">
            <span>üîê –õ–æ–≥–∏–Ω (–ª–∞—Ç–∏–Ω–∏—Ü–∞, –æ—Ç 3 –±—É–∫–≤)</span>
            <input type="text" id="regLogin" name="login" pattern="[a-zA-Z]{3,}" required />
          </div>
          <div class="field">
            <span>üîë –ü–∞—Ä–æ–ª—å</span>
            <input type="password" id="regPassword" name="password" required />
          </div>
          <button type="submit" class="btn btn-primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
          <button type="button" id="showLoginBtn" class="btn btn-link">–£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? –í–æ–π—Ç–∏</button>
        </form>
        <div id="registrationError" class="error-message" style="display: none;"></div>
      </div>
    </div>

    <!-- Login Screen -->
    <div id="loginScreen" class="screen" style="display: none;">
      <div class="auth-card">
        <h2>üîê –í—Ö–æ–¥</h2>
        <form id="loginForm">
          <div class="field">
            <span>üîê –õ–æ–≥–∏–Ω</span>
            <input type="text" id="loginLogin" name="login" required />
          </div>
          <div class="field">
            <span>üîë –ü–∞—Ä–æ–ª—å</span>
            <input type="password" id="loginPassword" name="password" required />
          </div>
          <button type="submit" class="btn btn-primary">–í–æ–π—Ç–∏</button>
          <button type="button" id="showRegistrationBtn" class="btn btn-link">–ù–µ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞? –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
        </form>
        <div id="loginError" class="error-message" style="display: none;"></div>
      </div>
    </div>

    <!-- Main App Header -->
    <header class="header" id="mainHeader" style="display: none;">
      <div class="header-content">
        <button id="personalCabinetBtn" class="header-btn">
          üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç
        </button>
        <div class="brand">
          <div class="logo" aria-hidden="true">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7 3h10a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2Z" stroke="currentColor" stroke-width="1.8"/>
              <path d="M8 7h8M8 11h8M8 15h5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
              <path d="M17 16.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z" fill="currentColor"/>
            </svg>
          </div>
          <div>
            <h1>–í–≤–æ–¥ –í–ì–• / –ü—Ä–æ–±–ª–µ–º</h1>
            <p class="sub">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –ø–æ–ª—è, –ø—Ä–∏–ª–æ–∂–∏—Ç–µ —Ñ–æ—Ç–æ/–≤–∏–¥–µ–æ –∏ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ ‚Äî –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Google —Ç–∞–±–ª–∏—Ü—É –∏ —É–π–¥—É—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.</p>
          </div>
        </div>
        <button id="logoutBtn" class="header-btn">
          üö™ –í—ã–π—Ç–∏
        </button>
      </div>
    </header>

    <section class="card">
      <form id="requestForm">
        <div class="grid">
          <label class="field softHl">
            <span>üè≠ –ü–æ—Å—Ç–∞–≤—â–∏–∫</span>
            <input name="supplier" type="text" />
          </label>

          <label class="field hlInput">
            <span>üßæ –õ–ö —Ç–æ–≤–∞—Ä–∞</span>
            <input name="lk" type="text" pattern="[A-Za-z0-9–ê-–Ø–∞-—è–Å—ë]+" title="–¢–æ–ª—å–∫–æ –±—É–∫–≤—ã –∏ —Ü–∏—Ñ—Ä—ã" required />
          </label>

          <label class="field">
            <span>üìù –ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
            <input name="product_name" type="text" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ú–æ–ª–æ–∫–æ 3.2% 1–ª" />
          </label>

          <div class="field full">
            <span>üè∑Ô∏è –¢–∏–ø —Ç–æ–≤–∞—Ä–∞</span>
            <div class="typeGrid" role="radiogroup" aria-label="–¢–∏–ø —Ç–æ–≤–∞—Ä–∞">
              <label class="typeBtn">
                <input type="radio" name="product_type" value="dry" required />
                <span class="typeText">ü•´ –°—É—Ö–æ–π</span>
              </label>
              <label class="typeBtn">
                <input type="radio" name="product_type" value="fresh" />
                <span class="typeText">ü•© –§–†–ï–®</span>
              </label>
              <label class="typeBtn">
                <input type="radio" name="product_type" value="frov" />
                <span class="typeText">ü•¶ –§–†–û–í</span>
              </label>
              <label class="typeBtn">
                <input type="radio" name="product_type" value="frozen" />
                <span class="typeText">‚ùÑÔ∏è –ó–∞–º–æ—Ä–æ–∑–∫–∞</span>
              </label>
              <label class="typeBtn">
                <input type="radio" name="product_type" value="strong_alcohol" />
                <span class="typeText">ü•É –ö—Ä–µ–ø–∫–∏–π –∞–ª–∫–æ–≥–æ–ª—å</span>
              </label>
            </div>
          </div>

          <label class="field hlInput">
            <span>üìè –î–ª–∏–Ω–∞ (—Å–º)</span>
            <input name="d_cm" type="text" inputmode="numeric" data-digits-only="true" required />
          </label>

          <label class="field hlInput">
            <span>üìè –®–∏—Ä–∏–Ω–∞ (—Å–º)</span>
            <input name="w_cm" type="text" inputmode="numeric" data-digits-only="true" required />
          </label>

          <label class="field hlInput">
            <span>üìè –í—ã—Å–æ—Ç–∞ (—Å–º)</span>
            <input name="h_cm" type="text" inputmode="numeric" data-digits-only="true" required />
          </label>

          <label class="field hlInput">
            <span>‚öñÔ∏è –í–µ—Å (–∫–≥)</span>
            <input name="weight_kg" type="text" inputmode="decimal" required />
          </label>

          <label class="field">
            <span>üßä –ë–ª–æ–∫ (—à—Ç) (—Ç–ø—Ä2) –µ—Å–ª–∏ –µ—Å—Ç—å</span>
            <input name="tpr2" type="text" inputmode="numeric" data-digits-only="true" />
          </label>

          <label class="field hlInput">
            <span>üì¶ –ö–æ—Ä–æ–±–∫–∞ (—à—Ç) (—Ç–ø—Ä3)</span>
            <input name="tpr3" type="text" inputmode="numeric" data-digits-only="true" required />
          </label>

          <label class="field hlInput">
            <span>üì¶ –ü–∞–ª–ª–µ—Ç (—É–ø) (—Ç–ø—Ä4)</span>
            <input name="tpr4" type="text" inputmode="numeric" data-digits-only="true" required />
          </label>

          <label class="field hlInput">
            <span>‚è≥ –°—Ä–æ–∫ –≥–æ–¥–Ω–æ—Å—Ç–∏ (–¥–Ω–µ–π)</span>
            <input name="sg_days" type="text" inputmode="numeric" data-digits-only="true" required />
          </label>

          <div class="field full">
            <span>–†–∞—Å—á—ë—Ç –°–ì –≤ % (–æ—Å—Ç–∞—Ç–æ–∫)</span>
            <div class="sgCalc">
              <label class="field">
                <span>–î–∞—Ç–∞ –∏–∑–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è</span>
                <input name="mfg_date" type="date" />
              </label>

              <label class="field">
                <span>–ì–æ–¥–µ–Ω –¥–æ</span>
                <input id="expiryDateOut" name="expiry_date" type="text" readonly />
              </label>

              <div class="field">
                <span>&nbsp;</span>
                <button id="calcSgBtn" type="button" class="secondary">–†–∞—Å—Å—á–∏—Ç–∞—Ç—å –°–ì %</button>
              </div>

              <label class="field full">
                <span>–û—Å—Ç–∞—Ç–æ–∫ –°–ì (%)</span>
                <input id="sgPercent" name="sg_percent" type="text" readonly />
              </label>
            </div>
          </div>

          <div class="field full">
            <span class="labelRow">
              <span>‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞</span>
            </span>
            <button id="chooseProblemBtn" type="button" class="secondary">–í—ã–±—Ä–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—É</button>
            <div id="problemGrid" class="problemGrid" role="radiogroup" aria-label="–ü—Ä–æ–±–ª–µ–º–∞" hidden>
              <label class="problemBtn">
                <input type="radio" name="problem" value="barcode_not_scanning" />
                <span class="problemIcon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 7v10M7 5v14M11 7v10M15 5v14M19 7v10" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                    <path d="M21 12h-4" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                    <path d="M17 10l-2 2 2 2" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="problemText">–®–ö –Ω–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è</span>
              </label>

              <label class="problemBtn">
                <input type="radio" name="problem" value="stuck_on_gm" />
                <span class="problemIcon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 8v5" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/>
                    <path d="M12 16h.01" stroke="currentColor" stroke-width="2.6" stroke-linecap="round"/>
                    <path d="M10.3 4.8h3.4c.6 0 1.1.3 1.4.8l6.2 10.7c.3.5.3 1.2 0 1.7-.3.5-.9.8-1.5.8H4.6c-.6 0-1.2-.3-1.5-.8-.3-.5-.3-1.2 0-1.7l6.2-10.7c.3-.5.8-.8 1.4-.8Z" stroke="currentColor" stroke-width="1.6"/>
                  </svg>
                </span>
                <span class="problemText">–ó–∞–≤–∏—Å–ª–æ –Ω–∞ –ì–ú</span>
              </label>
            </div>
          </div>

          <div id="barcodeNotScanningDetails" class="field full" hidden>
            <span>–®–ö –Ω–µ —Å–∫–∞–Ω–∏—Ä—É–µ—Ç—Å—è ‚Äî –ø—Ä–∏—á–∏–Ω–∞</span>
            <select name="barcode_not_scanning_reason">
              <option value="" selected disabled>–í—ã–±–µ—Ä–∏—Ç–µ...</option>
              <option value="physical">–§–∏–∑–∏—á–µ—Å–∫–∏</option>
              <option value="wrong_product">–ü–∏—à–µ—Ç –Ω–µ –≤–µ—Ä–Ω—ã–π —Ç–æ–≤–∞—Ä (–Ω–µ—Ç –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ)</option>
            </select>
          </div>

          <label class="field full">
            <span>–§–æ—Ç–æ: –®–ö –ö–æ—Ä–æ–±–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
            <input id="photoBarcodeBox" name="photo_barcode_box" type="file" accept="image/*" required />
          </label>

          <label id="photoBarcodeBlockWrap" class="field full" hidden>
            <span>–§–æ—Ç–æ: –ë–ª–æ–∫ (–µ—Å–ª–∏ –µ—Å—Ç—å –±–ª–æ–∫)</span>
            <input id="photoBarcodeBlock" name="photo_barcode_block" type="file" accept="image/*" />
          </label>

          <label class="field full">
            <span>–§–æ—Ç–æ: –®–ö –®—Ç—É–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
            <input id="photoBarcodeItem" name="photo_barcode_item" type="file" accept="image/*" required />
          </label>

          <label class="field full">
            <span>–§–æ—Ç–æ: –û–±—â–∏–π –≤–∏–¥ –∫–æ—Ä–æ–±–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
            <input id="photoBoxOverall" name="photo_box_overall" type="file" accept="image/*" required />
          </label>

          <label class="field full">
            <span>–í–ª–æ–∂–µ–Ω–∏—è –∫–æ—Ä–æ–±–∫–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</span>
            <input id="boxAttachments" name="box_attachments" type="file" multiple accept="image/*,video/*" required />
            <small id="filesHint" class="hint"></small>
          </label>

          <label class="field full">
            <span>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</span>
            <textarea name="comment" rows="4" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏"></textarea>
          </label>
        </div>

        <div class="actions">
          <button id="submitBtn" type="submit">
            <span class="btnText">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</span>
            <span class="btnSpinner" aria-hidden="true"></span>
          </button>
        </div>

        <div id="status" class="status" aria-live="polite"></div>

        <div class="actions">
          <button id="installBtn" type="button" class="secondary" hidden>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</button>
        </div>
      </form>
    </section>

    <!-- Personal Cabinet Screen -->
    <section id="personalCabinetScreen" class="card screen" style="display: none;">
      <h2>üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç</h2>
      <div id="userInfo" class="user-info"></div>
      <div class="cabinet-tabs">
        <button class="tab-btn active" data-tab="requests">–ú–æ–∏ –∑–∞—è–≤–∫–∏</button>
        <button class="tab-btn" data-tab="drafts">–ß–µ—Ä–Ω–æ–≤–∏–∫–∏</button>
      </div>
      <div id="requestsTab" class="tab-content active">
        <h3>–ò—Å—Ç–æ—Ä–∏—è –∑–∞—è–≤–æ–∫</h3>
        <div id="requestsList" class="requests-list"></div>
      </div>
      <div id="draftsTab" class="tab-content">
        <h3>–ß–µ—Ä–Ω–æ–≤–∏–∫–∏</h3>
        <div id="draftsList" class="drafts-list"></div>
      </div>
    </section>

    <!-- Admin Cabinet Screen -->
    <section id="adminCabinetScreen" class="card screen" style="display: none;">
      <h2>üõ†Ô∏è –ê–¥–º–∏–Ω—Å–∫–∏–π –∫–∞–±–∏–Ω–µ—Ç</h2>
      <div class="admin-stats">
        <div class="stat-card">
          <h3>–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫</h3>
          <span id="totalRequests">0</span>
        </div>
        <div class="stat-card">
          <h3>–ù–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫</h3>
          <span id="newRequests">0</span>
        </div>
        <div class="stat-card">
          <h3>–í —Ä–∞–±–æ—Ç–µ</h3>
          <span id="inProgressRequests">0</span>
        </div>
      </div>
      <div class="admin-filters">
        <select id="statusFilter">
          <option value="all">–í—Å–µ —Å—Ç–∞—Ç—É—Å—ã</option>
          <option value="new">–ù–æ–≤—ã–µ</option>
          <option value="in_progress">–í —Ä–∞–±–æ—Ç–µ</option>
          <option value="completed">–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ</option>
          <option value="rejected">–û—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã–µ</option>
        </select>
        <input type="text" id="searchFilter" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∑–∞—è–≤–∫–∞–º...">
      </div>
      <div id="adminRequestsList" class="admin-requests-list"></div>
    </section>

    <!-- Request Detail Modal -->
    <div id="requestDetailModal" class="modal" hidden>
      <div class="modalBackdrop" data-action="close"></div>
      <div class="modalCard" role="dialog" aria-modal="true">
        <div class="modalTitle">–î–µ—Ç–∞–ª–∏ –∑–∞—è–≤–∫–∏</div>
        <div class="modalBody" id="requestDetailBody"></div>
        <div class="modalActions" id="requestDetailFooter"></div>
      </div>
    </div>

    <section class="card queueCard" aria-label="–û—á–µ—Ä–µ–¥—å –æ—Ç–ø—Ä–∞–≤–∫–∏">
      <div class="queueHeader">
        <div class="queueTitle">–û—á–µ—Ä–µ–¥—å</div>
        <button id="flushQueueBtn" type="button" class="secondary">–û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—á–µ—Ä–µ–¥—å</button>
      </div>
      <div id="queueEmpty" class="hint">–û—á–µ—Ä–µ–¥—å –ø—É—Å—Ç–∞</div>
      <ul id="queueList" class="queueList"></ul>
    </section>

    <footer class="footer">
      <span id="offlineBadge" class="badge" hidden>–û—Ñ—Ñ–ª–∞–π–Ω</span>
    </footer>
  </main>

  <div id="successModal" class="modal" hidden>
    <div class="modalBackdrop" data-action="close"></div>
    <div class="modalCard" role="dialog" aria-modal="true" aria-label="–£—Å–ø–µ—à–Ω–æ">
      <div class="modalTitle">–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ</div>
      <div class="modalBody">–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞.</div>
      <div class="modalActions">
        <button id="successModalOkBtn" type="button" class="secondary">–û–ö</button>
      </div>
    </div>
  </div>

  <script src="./app.js" type="module"></script>
</body>
</html>
